package me.stojan.pasbox.hkdf

import java.security.Key
import javax.crypto.Mac
import javax.crypto.spec.SecretKeySpec

object HKDF {
  val MASTER_KEY_AES256 = byteArrayOf(
    -58, -104, -74, 19, 95, 122, 37, 62, 47, 37, 56, 97, -41, 113, 56, 15,
    -123, -27, 98, 15, -68, -76, -39, -20, 21, -63, -125, -121, -121, -81, 78, -30,
    93, 30, -21, 39, 125, 108, -92, -97, -73, 38, -95, -76, 36, -111, -33, -65,
    76, 46, 21, 42, -94, 43, 54, -67, 119, -2, 16, -56, -92, 48, -24, -101
  )

  val USER_AUTHENTICATON_HMAC_SHA256 = byteArrayOf(
    -2, 81, 40, -102, 45, -82, 101, 104, -2, -115, -49, 19, -86, 18, -41, -77,
    -9, 111, -52, -48, -84, 70, -98, 126, -95, -123, -64, -46, -64, -17, -42, -8,
    -111, 114, -11, -57, -86, -128, -71, -57, 126, -82, 0, -12, -48, -56, 30, 91,
    108, 93, 111, 53, -23, -38, 57, -13, 80, -63, -118, 42, -87, -62, -119, 4
  )

  val USER_ECDH_CURVE25519 = byteArrayOf(
    20, -8, 80, -9, -32, -10, -47, -37, 73, 57, -79, -18, -123, 124, 27, 28,
    112, -29, -67, 5, -92, 112, 102, -34, 9, 115, -112, 112, -70, 72, -56, -65,
    121, -51, 64, -11, 42, -95, 108, 9, -78, -116, 126, -46, 50, -30, -116, -15,
    -16, -96, 74, -9, -97, -48, 104, 22, -8, 28, -47, 63, 85, 108, 124, 64
  )

  val USER_ECDSA_CURVE25519 = byteArrayOf(
    -12, -68, -103, -73, 91, 117, -104, 59, 104, -40, -107, 115, -103, -11, -59, 41,
    -117, 10, -103, 23, 36, -26, 52, -32, 75, 20, -82, -70, 48, 66, -99, 12,
    57, 68, 24, 8, -99, -76, 120, -89, 73, -31, 65, -73, -46, -114, -53, -27,
    17, -57, -118, -46, 73, 117, 91, -54, 102, -113, -84, -94, 92, 12, -122, -89
  )

  val USER_OPENER_HKDF_SHA256 = byteArrayOf(
    88, 29, -106, 75, -60, -37, -102, 1, 11, -27, 69, -39, 27, 17, -83, -91,
    -104, 91, -107, -17, -6, -101, -8, 105, 33, 120, -92, 82, 15, 86, -91, -107,
    -112, -73, -89, -34, 66, 100, 68, 116, 68, -90, 21, -85, 43, 115, 109, 56,
    -52, -36, 2, 1, -6, -116, -16, -3, -73, 118, -10, 11, -28, -90, -119, -25
  )

  val USER_MASTER_KEY_OPENER = byteArrayOf(
    -8, 95, -10, 95, 89, -25, -35, 66, -42, -62, 11, -16, -41, -114, 127, 73,
    119, -37, -98, 95, -117, -80, -55, -126, -59, -126, 119, -46, 88, 120, -122, -6,
    118, -26, 95, -100, 45, 75, -71, -57, -123, 70, 9, 28, 88, -17, 25, 97,
    48, 5, -100, -57, 103, -88, 117, -98, 66, 91, -113, -89, 22, 14, 8, 94
  )

  fun derive256(key: Key, data: ByteArray) =
    Mac.getInstance("HmacSHA256")
      .run {
        init(key)
        doFinal(data)
      }

  fun derive512(key: Key, data: ByteArray) =
    Mac.getInstance("HmacSHA512")
      .run {
        init(key)
        doFinal(data)
      }

  fun derive256(secret: ByteArray, data: ByteArray) = derive256(SecretKeySpec(secret, "HmacSHA256"), data)!!

  fun derive512(secret: ByteArray, data: ByteArray) = derive512(SecretKeySpec(secret, "HmacSHA512"), data)!!

}